Bootstrap: docker
From: python:3.9

%files
    ./src /app
    ./start.sh /start.sh

%post
    pip3 install fschat==0.2.7

    DEBIAN_FRONTEND=noninteractive apt update -y && apt install -y git curl

    curl -s https://packagecloud.io/install/repositories/github/git-lfs/script.deb.sh | bash
    
    DEBIAN_FRONTEND=noninteractive apt install -y git-lfs

    DEBIAN_FRONTEND=noninteractive apt install -y nginx

    pip3 install sentencepiece einops
    
    chmod +x /start.sh

%runscript
    echo "Arguments received: $*"
    exec echo "$@"
    sh /start.sh

%environment
    export LISTEN_PORT=12345
